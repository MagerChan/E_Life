function insert_serveday(e){$("#serveday").empty();for(var a=getNowTime(),t=0;t<e;t++){var s=document.createElement("div");s.className="servedayitem",s.id="servedayitem_tag_"+t;var r=weekday_(t,a.week),o=a.month,n=a.date_,i=monthday(a.month,a.year);a.date_+t>i?(o++,n=(n+t)%i):n+=t,0==t&&(serve_weekday_=o+"月"+n+"日("+r+")"),o=o<10?"0"+o:o,n=n<10?"0"+n:n;var c=o+"/"+n;s.innerHTML="<p>"+r+"</p><p>"+c+"</p>",$(s).data("pos",t),$(s).click(function(){onTagClick(this)}),$("#serveday").append(s);var d=document.createElement("div");d.id="servetime"+t,d.className="servetime",$("#all_servetime").append(d),insert_servetime(21,t)}}function insert_servetime(e,a){$("#servetime"+a).empty();for(var t=8,s=0;s<e;s++){var r=document.createElement("div");r.className="servetimeitem",r.id="servetimeitem_tag_"+a+"_"+s,s%2==0&&s>0&&t++;var o=t;t=t<10?"0"+t:t;var n=s%2==0?"00":"30";r.innerHTML="<p>"+t+":"+n+"</p><p>￥70</p>",t=o;var i=getNowTime().hour;0==a&&t<i+1?$(r).addClass("servetime_over"):($(r).data("pos",s),$(r).click(function(){onServeTimeClick(this,a)})),$("#servetime"+a).append(r)}}function onTagClick(e){var a=e,t=$(a).data("pos");$(".servetimeitem").removeClass("selectitem");for(var s=0;s<5;s++)$("#servedayitem_tag_"+s).removeClass("selectitem"),$("#servetime"+s).css("display","none");$("#servedayitem_tag_"+t).addClass("selectitem"),$("#servetime"+t).css("display","block");var r=$(a).find("p:first-child").html(),o=$(a).find("p:last-child").html(),n="0"==o.substring(0,1)?o.substring(1,2):o.substring(0,3),i=o.substring(3,5);serve_weekday_=n+"月"+i+"日("+r+")"}function onServeTimeClick(e,a){for(var t=e,s=$(t).data("pos"),r=0;r<21;r++)$("#servetimeitem_tag_"+a+"_"+r).removeClass("selectitem");$("#servetimeitem_tag_"+a+"_"+s).addClass("selectitem"),serve_time_=$(t).find("p:first-child").html(),orderclick()}function weekday_(e,a){var t="";if(0==e)t="今天";else if(1==e)t="明天";else{var s=(a+e)%7;switch(s){case 0:t="周日";break;case 1:t="周一";break;case 2:t="周二";break;case 3:t="周三";break;case 4:t="周四";break;case 5:t="周五";break;case 6:t="周六"}}return t}function monthday(e,a){var t=0;switch(e){case 1:t=31;break;case 2:t=a%4!=0||a%100==0&&a%400!=0?28:29;break;case 3:t=31;break;case 4:t=30;break;case 5:t=31;break;case 6:t=30;break;case 7:t=31;break;case 8:t=31;break;case 9:t=30;break;case 10:t=31;break;case 11:t=10;break;case 12:t=31}return t}function getNowTime(){var e=Date.parse(new Date);e/=1e3;var a=getLocalTime(e);return a}function getaddrinfo(){$.ajax({url:"http://139.199.198.216/get_serve_addr.php?",type:"GET",dataType:"jsonp",jsonp:"jsoncallback",timeout:15e3,success:function(e){e.ret&&$("#addr_info_").html(e.addr_info)},error:function(e,a,t){ELife_UI.Toast.show("服务器繁忙，请稍后重试"),window.setTimeout(function(){ELife_UI.Toast.hide()},2e3)}})}function orderclick(){""!=$("#addr_info_").html()&&""!=serve_weekday_&&""!=serve_time_?btn_is_click(!0,"#place_order"):btn_is_click(!1,"#place_order")}function addorderSuccess(){ELife_UI.Toast.show("添加订单成功，我们将为你提供优质服务"),window.setTimeout(function(){ELife_UI.Toast.hide(),location.replace("../../debug/tmpl/index.html")},2e3)}function addorderFail(){ELife_UI.Toast.show("网络繁忙，请稍后重试"),window.setTimeout(function(){ELife_UI.Toast.hide()},2e3)}var serve_weekday_="",serve_time_="",cost="";$("#addservetime").click(function(){$("#serveday").css("display","block"),insert_serveday(5),$("#servedayitem_tag_0").addClass("selectitem")}),$("#houradd").click(function(){$("#hoursub").removeClass("nouse");var e=parseInt($("#hournum").html());e++,e<6?($("#hournum").html(e),5==e&&$("#houradd").addClass("nouse")):$("#houradd").addClass("nouse")}),$("#hoursub").click(function(){$("#houradd").removeClass("nouse");var e=parseInt($("#hournum").html());e--,e>1?($("#hournum").html(e),2==e&&$("#hoursub").addClass("nouse")):$("#hoursub").addClass("nouse")}),$("#auntadd").click(function(){$("#auntsub").removeClass("nouse");var e=parseInt($("#auntnum").html());e++,e<4?($("#auntnum").html(e),3==e&&$("#auntadd").addClass("nouse")):$("#auntadd").addClass("nouse")}),$("#auntsub").click(function(){$("#auntadd").removeClass("nouse");var e=parseInt($("#auntnum").html());e--,e>0?($("#auntnum").html(e),1==e&&$("#auntsub").addClass("nouse")):$("#auntsub").addClass("nouse")}),$("#palceorderback").click(function(){window.history.back()}),getaddrinfo(),$("#confirmorderback").click(function(){$("#placeorder_page").css("display","block"),$("#confirmorder_page").css("display","none")}),$("#serveaddr").click(function(){orderclick()}),$("#place_order").click(function(){var e=$("#addr_info_").html(),a=$("#hournum").html(),t=$("#auntnum").html();$("#c_order_addr").html(e),$("#c_order_aunt").html(t+"位阿姨"),$("#c_order_duration").html(a+"小时"),$("#c_order_time").html(serve_weekday_+" "+serve_time_),$("#placeorder_page").css("display","none"),$("#confirmorder_page").css("display","block"),$.ajax({type:"get",url:"http://139.199.198.216/get_order_info.php?",dataType:"jsonp",jsonp:"jsoncallback",timeout:15e3,success:function(e){$("#c_order_type").html(e.servename),$("#c_order_cost").html(e.servecost+"元x"+a);var t=parseInt(e.servecost)*parseInt(a);cost=t,$("#totalmoney").html(t+"元"),$("#confirm_money").html("￥"+t)},error:function(e,a,t){ELife_UI.Toast.show("服务器繁忙，请稍后重试"),window.setTimeout(function(){ELife_UI.Toast.hide()},2e3)}})}),$("#confirm_order").click(function(){var e=($("#addr_info_").html(),$("#hournum").html()),a=$("#auntnum").html();$.ajax({type:"get",url:"http://139.199.198.216/place_order.php?h="+e+"&a_n="+a+"&t="+serve_weekday_+" "+serve_time_+"&cost="+cost,dataType:"jsonp",jsonp:"jsoncallback",timeout:15e3,success:function(e){e.ret?addorderSuccess():addorderFail()},error:function(e,a,t){console.log(e.readyState),console.log(e.status),console.log(a),ELife_UI.Toast.show("服务器繁忙，请稍后重试"),window.setTimeout(function(){ELife_UI.Toast.hide()},2e3)}})});