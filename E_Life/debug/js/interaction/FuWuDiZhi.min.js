function get_addr(){$.ajax({type:"get",url:"http://139.199.198.216/get_addr.php?",dataType:"jsonp",jsonp:"jsoncallback",timeout:15e3,success:function(e){if(console.log(e),e.ret){$(".no_address").css("display","none");for(var t=0;t<e.result.length;t++)insert_addr(e.result[t].name,e.result[t].detail_addr,e.result[t].tel,e.result[t]._id)}else e.nologin?$(".no_address").css("display","block"):$(".no_address").css("display","none")},error:function(e,t,d){console.log(e.readyState),console.log(e.status),console.log(t),ELife_UI.Toast.show("服务器繁忙，请稍后重试"),window.setTimeout(function(){ELife_UI.Toast.hide()},2e3)}})}function insert_addr(e,t,d,n){var i=document.createElement("a"),a="";if("index"==urlobj){var o=.45*document.body.offsetWidth;a="<li class='address'><div class='addr_left'><p>"+e+"</p><p>"+t+"</p></div><div class='addr_right'>"+d+"</div><div class='div_btn'><a class='btn_edit btn_edit_item' style='width:"+o+"px'>编辑</a><a class='btn_delete btn_edit_item' style='width:"+o+"px'>删除</a></div></li>"}else if("order"==urlobj){var o=.3*document.body.offsetWidth;a="<li class='address'><div class='addr_left'><p>"+e+"</p><p>"+t+"</p></div><div class='addr_right'>"+d+"</div><div class='div_btn'><a class='btn_view btn_edit_item' style='width:"+o+"px'>选中</a><a class='btn_edit btn_edit_item' style='width:"+o+"px'>编辑</a><a class='btn_delete btn_edit_item' style='width:"+o+"px'>删除</a></div></li>"}i.innerHTML=a,$(i).data("addr_id",n),$(i).find(".address").click(function(){onitemClick(this)}),$(i).find(".btn_view").on("click",function(){onChooseAlbum(this,n)}),$(i).find(".btn_edit").on("click",function(){onEditAlbum(this,n)}),$(i).find(".btn_delete").on("click",function(){onDeleteAddrClk(this)}),$("#ul_addr_list").prepend(i)}function onitemClick(e){var t=60,d=105,n=e;n.offsetHeight==t?(null!=curExtendItem&&(curExtendItem.style.height=t+"px"),n.style.height=d+"px",curExtendItem=n):(n.style.height=t+"px",curExtendItem=null)}function onChooseAlbum(e,t){chooseContent=$(e).parent().parent().find(".addr_left").find("p:last-child").html(),$.ajax({type:"get",url:"http://139.199.198.216/save_addr_info.php?addr_info="+chooseContent+"&addr_id="+t,dataType:"jsonp",jsonp:"jsoncallback",timeout:15e3,success:function(e){history.go(-1),location.reload()},error:function(e,t,d){ELife_UI.Toast.show("服务器繁忙，请稍后重试"),window.setTimeout(function(){ELife_UI.Toast.hide()},2e3)}})}function onEditAlbum(e,t){var d=$(e).parent().parent().find(".addr_left").find("p:first-child").html(),n=$(e).parent().parent().find(".addr_left").find("p:last-child").html(),i=$(e).parent().parent().find(".addr_right").html();$("#show_addr").addClass("dis_none"),$("#edit_addr").removeClass("dis_none"),$("#edit_name_change").val(d),$("#edit_tel_change").val(i),$("#edit_addr_change").val(n),$("#id_hidden").val(t)}function onDeleteAddrClk(e){ELife_UI.Message.show({title:"",message:"确定要删除地址吗?",ok:function(){var t=$(e).parent().parent().parent(),d=t.data("addr_id");$.ajax({url:"http://139.199.198.216/delete_addr.php?addr_id="+d,type:"GET",dataType:"jsonp",jsonp:"jsoncallback",timeout:15e3,success:function(e){e.ret?console.log("delete success"):console.log("delete fail")},error:function(e,t,d){console.log(e.readyState),console.log(e.status),console.log(t),ELife_UI.Toast.show("服务器繁忙，请稍后重试"),window.setTimeout(function(){ELife_UI.Toast.hide()},2e3)}});for(var n=$("#ul_addr_list"),i=n.children(),a=0;a<i.length;a++)if($(i[a]).data("addr_id")==d){$(i[a]).remove();break}},cancel:function(){}})}function editaddrFail(){ELife_UI.Toast.show("网络繁忙，请稍后重试"),window.setTimeout(function(){ELife_UI.Toast.hide()},2e3)}function editaddrsuccess(){ELife_UI.Toast.show("修改地址成功"),window.setTimeout(function(){ELife_UI.Toast.hide(),location.reload()},2e3)}var curExtendItem=null,chooseContent="",urlobj=GetQueryString("page");null!=urlobj&&urlobj.toString().length>1&&(urlobj=GetQueryString("page")),get_addr(),$("#edit_name_change").keyup(function(){""!=$("#edit_name_change").val()?btn_is_click(!0,"#save_change_addr"):btn_is_click(!1,"#save_change_addr")}),$("#edit_tel_change").keyup(function(){11==$("#edit_tel_change").val().length?btn_is_click(!0,"#save_change_addr"):btn_is_click(!1,"#save_change_addr")}),$("#edit_addr_change").keyup(function(){""!=$("#edit_addr_change").val()?btn_is_click(!0,"#save_change_addr"):btn_is_click(!1,"#save_change_addr")}),$("#save_change_addr").click(function(){var e=$("#edit_name_change").val(),t=$("#edit_tel_change").val(),d=$("#edit_addr_change").val(),n=$("#id_hidden").val();$.ajax({type:"get",url:"http://139.199.198.216/edit_addr.php?name="+e+"&addr="+d+"&tel="+t+"&id="+n,dataType:"jsonp",jsonp:"jsoncallback",timeout:15e3,success:function(e){e.ret?editaddrsuccess():editaddrFail()},error:function(e,t,d){console.log(e.readyState),console.log(e.status),console.log(t),ELife_UI.Toast.show("服务器繁忙，请稍后重试"),window.setTimeout(function(){ELife_UI.Toast.hide()},2e3)}})}),$("#edit_addr_back").click(function(){$("#show_addr").removeClass("dis_none"),$("#edit_addr").addClass("dis_none")}),$("#add_serve_addr").click(function(){location.href="../../debug/tmpl/add_addr.html"}),$("#fwdzback").click(function(){history.back()});